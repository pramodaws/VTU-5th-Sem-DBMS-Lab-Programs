Create table ACTOR
(
Act_ID int primary key,
Act_Name varchar(20),
Act_Gender varchar(20)
);


Create table DIRECTOR
(
Dir_ID int primary key,
Dir_Name varchar(20),
Dir_Phone number(20)
);

create table MOVIES
(
Mov_ID int primary key,
Mov_Title varchar(20),
Mov_Year int,
Mov_Lang varchar(20),
Dir_ID int references DIRECTOR(Dir_ID)
);

create table MOVIE_CAST
(
Act_ID int references ACTOR(Act_ID),
Mov_ID int references MOVIES(Mov_ID),
Role varchar(20)
);

create table RATING
(
Mov_ID int references MOVIES(Mov_ID),
Rev_Stars varchar(20)
);


INSERT INTO ACTOR VALUES (301,'ANUSHKA','F'); 
INSERT INTO ACTOR VALUES (302,'PRABHAS','M');
INSERT INTO ACTOR VALUES (303,'PUNITH','M'); 
INSERT INTO ACTOR VALUES (304,'JERMY','M');

INSERT INTO DIRECTOR VALUES (60,'RAJAMOULI', 8751611001); 
INSERT INTO DIRECTOR VALUES (61,'HITCHCOCK', 7766138911); 
INSERT INTO DIRECTOR VALUES (62,'FARAN', 9986776531); 
INSERT INTO DIRECTOR VALUES (63,'STEVEN SPIELBERG', 8989776530);  

INSERT INTO MOVIES VALUES (1001,'BAHUBALI-2', 2017, 'TELAGU', 60); 
INSERT INTO MOVIES VALUES (1002,'BAHUBALI-1', 2015, 'TELAGU', 60); 
INSERT INTO MOVIES VALUES (1003,'AKASH', 2008, 'KANNADA', 61); 
INSERT INTO MOVIES VALUES (1004,'WAR HORSE', 2011, 'ENGLISH', 63); 

INSERT INTO MOVIE_CAST VALUES (301, 1002, 'HEROINE'); 
INSERT INTO MOVIE_CAST VALUES (301, 1001, 'HEROINE'); 
INSERT INTO MOVIE_CAST VALUES (303, 1003, 'HERO'); 
INSERT INTO MOVIE_CAST VALUES (303, 1002, 'GUEST'); 
INSERT INTO MOVIE_CAST VALUES (304, 1004, 'HERO'); 

INSERT INTO RATING VALUES (1001, 4); 
INSERT INTO RATING VALUES (1002, 2); 
INSERT INTO RATING VALUES (1003, 5); 
INSERT INTO RATING VALUES (1004, 4); 

1)
SELECT Mov_Title 
FROM MOVIES 
WHERE Dir_ID IN (SELECT Dir_ID
                             FROM DIRECTOR    
                             WHERE Dir_Name ='HITCHCOCK'); 
 

2)
SELECT Mov_Title  
FROM MOVIES M, MOVIE_CAST MV  
WHERE M.Mov_ID=MV.Mov_ID 
AND Act_ID IN (SELECT Act_ID 
               FROM MOVIE_CAST 
               GROUP BY Act_ID 
               HAVING COUNT (ACT_ID)>1) 
GROUP BY Mov_Title
HAVING COUNT (*)>1;


3)
SELECT A.ACT_NAME, A.ACT_NAME, C.MOV_TITLE, C.MOV_YEAR 
FROM ACTOR A, MOVIE_CAST B, MOVIES C   
WHERE A.ACT_ID=B.ACT_ID 
AND B.MOV_ID=C.MOV_ID 
AND C.MOV_YEAR NOT BETWEEN 2000 AND 2015; 

4)
SELECT MOV_TITLE, MAX (REV_STARS)   
FROM MOVIES   
INNER JOIN RATING USING (MOV_ID)   
GROUP BY MOV_TITLE HAVING MAX (REV_STARS)>0   
ORDER BY MOV_TITLE;

5)
UPDATE RATING  SET REV_STARS=5  
WHERE MOV_ID IN (SELECT MOV_ID 
                 FROM MOVIES   
                 WHERE DIR_ID IN (SELECT DIR_ID  
                                  FROM DIRECTOR  
                                  WHERE DIR_NAME = 'STEVEN SPIELBERG'));